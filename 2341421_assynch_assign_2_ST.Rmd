---
title: "2341421_Asynchronous_Assignment-2"
author: "ANUSHKA SHARMA"
date: "2025-12-16"
output: word_document
runtime: shiny
---

```{r}
library(shiny)

ui <- fluidPage(
  
  titlePanel("Sampling–2 : Stratified Sampling for Population Mean"),
  
  sidebarLayout(
    
    sidebarPanel(
      
      h4("Input Parameters"),
      
      numericInput("L", "Number of Subgroups", value = 4, min = 1),
      numericInput("B", "Sampling Bias (Margin of Error)", value = 2, min = 0.1),
      numericInput("lambda", "Time–Cost Tradeoff (λ)", value = 0.5, min = 0),
      
      tags$hr(),
      h4("Subgroup Details"),
      
      textInput("Nh", "Population Sizes (comma separated)", 
                value = "500,400,300,200"),
      
      textInput("Sh", "Standard Deviations", 
                value = "12,15,10,8"),
      
      textInput("ch", "Cost per Observation", 
                value = "50,60,40,30"),
      
      textInput("th", "Time per Observation", 
                value = "15,20,10,8"),
      
      tags$hr(),
      
      actionButton("generate", "Generate Output", 
                   class = "btn-primary")
    ),
    
    mainPanel(
      
      tabsetPanel(
        
        tabPanel(
          "Sample Size Output",
          h3("Required Sample Size (Stratified)"),
          tableOutput("sampleTable"),
          br(),
          strong(textOutput("totalSample"))
        ),
        
        tabPanel(
          "Visualisation",
          h3("Experimental Design Plot"),
          plotOutput("designPlot")
        ),
        
        tabPanel(
          "Methodology",
          p("This Shiny application implements Stratified Sampling (Sampling–2)"),
          tags$ul(
            tags$li("Population is divided into subgroups"),
            tags$li("Sample size is determined considering bias, cost and time"),
            tags$li("Optimal allocation ensures minimum variance"),
            tags$li("Output is used to estimate population mean")
          )
        ),
        
        tabPanel(
          "Submission",
          h4("GitHub & LinkedIn Links"),
          verbatimTextOutput("links"),
          br(),
          h4("Attendance"),
          p("This assignment is submitted towards 2 hours of attendance.")
        )
      )
    )
  )
)

server <- function(input, output) {
  
  sampling_data <- eventReactive(input$generate, {
    
    N_h <- as.numeric(strsplit(input$Nh, ",")[[1]])
    S_h <- as.numeric(strsplit(input$Sh, ",")[[1]])
    c_h <- as.numeric(strsplit(input$ch, ",")[[1]])
    t_h <- as.numeric(strsplit(input$th, ",")[[1]])
    
    weights <- N_h * S_h / sqrt(c_h + input$lambda * t_h)
    k <- sum(weights) / (input$B^2)
    n_h <- round(k * weights / sum(weights))
    
    data.frame(
      Subgroup = paste("Subgroup", 1:length(n_h)),
      Population = N_h,
      Sample_Size = n_h
    )
  })
  
  output$sampleTable <- renderTable({
    sampling_data()
  })
  
  output$totalSample <- renderText({
    paste("Total Sample Size =", sum(sampling_data()$Sample_Size))
  })
  
  output$designPlot <- renderPlot({
    barplot(
      sampling_data()$Sample_Size,
      names.arg = sampling_data()$Subgroup,
      col = "steelblue",
      xlab = "Subgroups",
      ylab = "Sample Size",
      main = "Stratified Sampling Experimental Design"
    )
  })
  
  output$links <- renderText({
    paste(
      "GitHub Repository:",
      "https://github.com/anushkasharma-a11y/Sampling_Techniques",
    )
  })
}

shinyApp(ui = ui, server = server)

```
